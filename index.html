<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Joy Zubeenda — Remembering Zubeen Garg</title>

<!-- External libraries -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>

<style>
:root {
  --accent:#0b74ff;--bg:#f6f7fb;--card:#ffffff;--text:#0b1726;
  --muted:#556;--glass:rgba(11,23,38,0.03);
  --card-shadow:0 6px 22px rgba(10,20,40,0.06);
  --max-width:1200px
}
body {
  margin:0;font-family:Inter,ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,Arial;
  background:var(--bg);color:var(--text);-webkit-font-smoothing:antialiased
}
.dark {
  --bg:#0b1220;--card:#0f1724;--text:#e6eef8;--muted:#9aa9c3;
  --glass:rgba(255,255,255,0.03);--card-shadow:0 8px 30px rgba(0,0,0,0.6)
}
.wrap{max-width:var(--max-width);margin:18px auto;padding:18px}
header{display:flex;gap:20px;align-items:center;justify-content:space-between}
.brand{display:flex;gap:16px;align-items:center}
.logo{width:80px;height:80px;border-radius:12px;
  background:linear-gradient(135deg,var(--accent),#66a6ff);
  display:flex;align-items:center;justify-content:center;
  color:white;font-weight:800;font-size:20px;box-shadow:var(--card-shadow)
}
.hero-text{max-width:900px}h1{font-size:42px;margin:0;line-height:1.1}
.tagline{margin-top:10px;color:var(--muted);font-size:18px}
.controls{display:flex;gap:10px;align-items:center}
button{cursor:pointer;padding:8px 12px;border-radius:8px;border:0}
.btn-primary{background:var(--accent);color:white;box-shadow:0 6px 20px rgba(11,116,255,0.12)}
.btn-ghost{background:transparent;border:1px solid rgba(0,0,0,0.06);color:var(--text)}
.grid{display:grid;grid-template-columns:2fr 1fr;gap:20px;margin-top:18px}
@media (max-width:980px){.grid{grid-template-columns:1fr}}
.card{background:var(--card);border-radius:12px;padding:14px;box-shadow:var(--card-shadow)}
.section-title{font-size:18px;margin:0 0 8px 0}
.muted{color:var(--muted);font-size:13px}
.counter{font-size:40px;font-weight:700;margin-top:6px}
.virtual-candles{display:flex;flex-wrap:wrap;gap:6px;margin-top:12px}
.candle{width:14px;height:36px;border-radius:6px;
  background:linear-gradient(180deg,#ffdd88,#ffb347);
  position:relative;box-shadow:0 8px 18px rgba(255,120,20,0.12)}
.candle:after{content:'';position:absolute;left:50%;transform:translateX(-50%);
  top:-8px;width:4px;height:8px;border-radius:6px;background:#fff;
  filter:drop-shadow(0 6px 12px rgba(255,200,60,0.25))}
.candle.glow{box-shadow:0 8px 32px rgba(255,140,40,0.35),
  0 0 22px rgba(255,160,30,0.18);transform:translateY(-3px)}
.small{font-size:13px}
.row{display:flex;gap:8px;align-items:center}
input,select,textarea{width:100%;box-sizing:border-box;padding:10px;
  border-radius:8px;border:1px solid rgba(10,20,30,0.06);
  font-size:14px;background:white}
textarea{resize:vertical}
.footer{margin-top:18px;text-align:center;color:var(--muted)}
.footer-links{display:flex;gap:15px;justify-content:center;margin-top:10px}
.footer-links button{background:none;border:none;color:var(--accent);
  cursor:pointer;text-decoration:underline;padding:0}
.map-container{height:360px;border-radius:8px;overflow:hidden}
.modal {
  display:none;
  position:fixed;inset:0;background:rgba(0,0,0,0.5);
  align-items:center;justify-content:center;padding:20px;z-index:9999
}
</style>
</head>

<body>
<div class="wrap" id="pageWrap">
  <header>
    <div class="brand">
      <div class="logo">JZ</div>
      <div class="hero-text">
        <h1>Remembering Zubeen Garg</h1>
        <div class="tagline">The Pride of Assam • 40+ Languages • 38,000+ Songs • Forever in Our Hearts</div>
      </div>
    </div>
    <div class="controls">
      <div class="pill small" id="modeLabel">Light Mode</div>
      <button id="modeToggle" class="btn-ghost">Switch</button>
    </div>
  </header>

  <!-- Candle counter & chart -->
  <div class="grid">
    <div class="card">
      <h3 class="section-title">Virtual Candles</h3>
      <div class="counter" id="candleCount">0</div>
      <canvas id="candleChart" height="100"></canvas>
      <button id="openCandleModal" class="btn-primary" style="margin-top:12px;">Light a Candle</button>
    </div>

    <div class="card">
      <h3 class="section-title">Share a Memory</h3>
      <button id="openMemoryForm" class="btn-primary">Add Your Tribute</button>
      <div id="memoryList" class="muted small" style="margin-top:10px;">No memories yet.</div>
    </div>
  </div>

  <!-- Global Legacy Map -->
  <div class="card map-container" style="margin-top:20px;">
    <h3>Global Legacy Map</h3>
    <div id="map" style="height:300px;"></div>
  </div>
</div>

<!-- Candle Modal -->
<div id="candleModal" class="modal">
  <div style="background:var(--card);padding:18px;border-radius:12px;max-width:720px;width:100%">
    <h3>Light a Candle</h3>
    <form id="candleForm">
      <input type="text" id="candleName" placeholder="Your name" required />
      <button type="submit" class="btn-primary">Submit</button>
      <button type="button" id="candleCancel" class="btn-ghost">Cancel</button>
    </form>
  </div>
</div>

<!-- Memory Modal -->
<div id="memoryModal" class="modal">
  <div style="background:var(--card);padding:18px;border-radius:12px;max-width:820px;width:100%">
    <h3>Share a Memory</h3>
    <form id="memoryForm">
      <input type="text" id="memoryName" placeholder="Your name" required />
      <textarea id="memoryText" placeholder="Write your memory..." required></textarea>
      <button type="submit" class="btn-primary">Submit</button>
      <button type="button" id="memoryCancel" class="btn-ghost">Cancel</button>
    </form>
  </div>
</div>

<!-- Contact Modal -->
<div id="contactModal" class="modal">
  <div style="background:var(--card);padding:18px;border-radius:12px;max-width:520px;width:100%">
    <h3>Contact Me</h3>
    <form id="contactForm">
      <input type="email" id="contactEmail" placeholder="Your email" required />
      <textarea id="contactMessage" placeholder="Your message..." required></textarea>
      <button type="submit" class="btn-primary">Send</button>
      <button type="button" id="contactCancel" class="btn-ghost">Cancel</button>
    </form>
  </div>
</div>

<script>
// Firebase config (replace with your own!)
firebase.initializeApp({
  apiKey: "YOUR_API_KEY",
  authDomain: "YOUR_DOMAIN",
  projectId: "YOUR_PROJECT_ID"
});
const db = firebase.firestore();

// Modal setup
function setupModal(openBtnId, modalId, cancelBtnId) {
  const openBtn = document.getElementById(openBtnId);
  const modal = document.getElementById(modalId);
  const cancelBtn = document.getElementById(cancelBtnId);
  if (!openBtn || !modal) return;
  openBtn.addEventListener('click', () => { modal.style.display = 'flex'; });
  cancelBtn.addEventListener('click', () => { modal.style.display = 'none'; });
  window.addEventListener('click', (e) => { if (e.target === modal) modal.style.display = 'none'; });
}
setupModal('openCandleModal','candleModal','candleCancel');
setupModal('openMemoryForm','memoryModal','memoryCancel');
setupModal('openContactModalBtn','contactModal','contactCancel');

// Dark mode toggle
const toggleBtn = document.getElementById("modeToggle");
const modeLabel = document.getElementById("modeLabel");
toggleBtn.addEventListener("click", () => {
  document.body.classList.toggle("dark");
  modeLabel.textContent = document.body.classList.contains("dark") ? "Dark Mode" : "Light Mode";
});

// Leaflet map
const map = L.map("map").setView([20, 80], 4);
L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
  attribution: "© OpenStreetMap contributors"
}).addTo(map);

// Example marker
L.marker([26.1445, 91.7362]).addTo(map).bindPopup("Guwahati, Assam — Zubeen's Legacy");

// Chart.js candle chart
const ctx = document.getElementById("candleChart").getContext("2d");
const candleChart = new Chart(ctx, {
  type: "bar",
  data: {
    labels: [],
    datasets: [{label:"Candles", data:[], backgroundColor:"#ffb347"}]
  },
  options: {responsive:true, plugins:{legend:{display:false}}}
});

// Candle form
const candleForm = document.getElementById("candleForm");
candleForm.addEventListener("submit", async(e)=>{
  e.preventDefault();
  const name = document.getElementById("candleName").value;
  await db.collection("candles").add({name, time:firebase.firestore.FieldValue.serverTimestamp()});
  candleForm.reset();
  document.getElementById("candleModal").style.display="none";
});

// Memory form
const memoryForm = document.getElementById("memoryForm");
memoryForm.addEventListener("submit", async(e)=>{
  e.preventDefault();
  const name = document.getElementById("memoryName").value;
  const text = document.getElementById("memoryText").value;
  await db.collection("memories").add({name,text,time:firebase.firestore.FieldValue.serverTimestamp()});
  memoryForm.reset();
  document.getElementById("memoryModal").style.display="none";
});

// Contact form (via EmailJS)
emailjs.init("YOUR_EMAILJS_USERID");
document.getElementById("contactForm").addEventListener("submit", (e)=>{
  e.preventDefault();
  emailjs.send("YOUR_SERVICE_ID","YOUR_TEMPLATE_ID",{
    email:document.getElementById("contactEmail").value,
    message:document.getElementById("contactMessage").value
  }).then(()=>alert("Message sent!"));
  e.target.reset();
  document.getElementById("contactModal").style.display="none";
});

// Live updates from Firestore
db.collection("candles").orderBy("time","asc").onSnapshot(snap=>{
  const count = snap.size;
  document.getElementById("candleCount").textContent = count;
  const labels = snap.docs.map((_,i)=>i+1);
  candleChart.data.labels = labels;
  candleChart.data.datasets[0].data = labels.map(()=>1);
  candleChart.update();
});

db.collection("memories").orderBy("time","desc").onSnapshot(snap=>{
  const list = document.getElementById("memoryList");
  if(snap.empty){list.textContent="No memories yet.";return;}
  list.innerHTML="";
  snap.forEach(doc=>{
    const d = doc.data();
    const div=document.createElement("div");
    div.textContent=`${d.name}: ${d.text}`;
    list.appendChild(div);
  });
});
</script>
</body>
</html>
