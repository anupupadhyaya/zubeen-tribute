<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Joy Zubeen Da - A Tribute to Zubeen Garg</title>

    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&display=swap" rel="stylesheet">

    <!-- Leaflet.js for Map -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0a0a0a;
            color: #e5e5e5;
        }
        .hero-bg {
            background-color: #111;
            background-image: radial-gradient(circle at 1px 1px, rgba(255,255,255,0.05) 1px, transparent 0);
            background-size: 20px 20px;
        }
        .card {
            background-color: rgba(23, 23, 23, 0.8);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .leaflet-popup-content-wrapper, .leaflet-popup-tip {
            background: #171717;
            color: #e5e5e5;
            box-shadow: 0 3px 14px rgba(0,0,0,0.4);
        }
        .leaflet-container {
            background: #1c1c1c;
        }
        .btn-primary { background: linear-gradient(to right, #ef4444, #f97316); color: white; }
        .btn-primary:hover { opacity: 0.9; }
        .stat-bar { background-color: rgba(239, 68, 68, 0.6); }

        /* Memory Carousel Animation */
        @keyframes fadeInOut {
            0%, 100% { opacity: 0; transform: translateY(10px); }
            10%, 90% { opacity: 1; transform: translateY(0); }
        }
        .carousel-item {
            display: none;
            animation: fadeInOut 10s infinite;
        }
        .carousel-item.active { display: block; }
    </style>
</head>
<body class="antialiased">

    <!-- App Container -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12 space-y-12">

        <!-- Hero Section -->
        <section class="hero-bg text-center py-16 md:py-24 rounded-2xl border border-zinc-800">
            <h1 class="text-4xl md:text-6xl font-black tracking-tighter text-transparent bg-clip-text bg-gradient-to-r from-red-500 to-amber-500">
                Remembering Zubeen Garg
            </h1>
            <p class="mt-4 text-lg md:text-xl text-zinc-400 max-w-3xl mx-auto">
                The Pride of Assam ‚Ä¢ 40+ Languages ‚Ä¢ 38,000+ Songs ‚Ä¢ Forever in Our Hearts
            </p>
        </section>

        <!-- Candle Lighting Section -->
        <section id="candle-section" class="grid grid-cols-1 lg:grid-cols-2 gap-8 items-center">
            <div class="card p-8 rounded-2xl text-center">
                <h2 class="text-3xl font-bold text-white mb-2">Light a Virtual Candle</h2>
                <p class="text-zinc-400 mb-6">Join thousands of fans in lighting a candle to honor Zubeen's eternal legacy.</p>
                <div class="cursor-pointer group" id="light-candle-btn">
                    <div class="text-8xl mb-4 group-hover:scale-110 transition-transform duration-300">üïØÔ∏è</div>
                    <p class="text-4xl font-bold text-amber-400" id="candle-total-count">0</p>
                    <p class="text-zinc-300">Candles Lit</p>
                </div>
            </div>
            <div id="candle-stats-container" class="card p-8 rounded-2xl">
                 <h3 class="text-2xl font-bold text-white mb-6">Global Candlelight Stats</h3>
                 <div id="candle-stats" class="space-y-5">
                    <!-- Stats will be dynamically inserted here -->
                 </div>
            </div>
        </section>
        
        <!-- Interactive Memory Wall Section -->
        <section id="memory-wall" class="card p-8 rounded-2xl">
            <div class="text-center mb-8">
                 <h2 class="text-3xl font-bold text-white">Interactive Memory Wall</h2>
                 <p class="text-zinc-400 mt-2">Personal stories from fans, rotating every 10 seconds.</p>
                 <p class="mt-2 text-sm font-bold text-amber-400"><span id="memory-count">0</span> memories shared</p>
            </div>
            <div id="memory-carousel" class="min-h-[150px] relative">
                <!-- Featured Memory Carousel will be here -->
            </div>
            <div class="text-center mt-8">
                <button id="add-memory-btn" class="btn-primary font-semibold py-3 px-6 rounded-lg">Share Your Memory</button>
            </div>
        </section>

        <!-- Tributes & Map Section -->
        <section class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- Fan Tributes Hub -->
            <div id="tribute-hub" class="lg:col-span-1 card p-8 rounded-2xl">
                <h2 class="text-3xl font-bold text-white">Fan Tributes Hub</h2>
                <p class="text-zinc-400 mt-2">Song covers, fan art, and poems from the community.</p>
                <p class="mt-2 text-sm font-bold text-amber-400"><span id="tribute-count">0</span> tributes featured</p>
                <div class="text-center mt-6">
                     <button id="add-tribute-btn" class="w-full bg-zinc-800 hover:bg-zinc-700 text-white font-semibold py-3 px-6 rounded-lg">Submit Your Tribute</button>
                </div>
                <div id="tributes-grid" class="mt-6 space-y-4 max-h-[400px] overflow-y-auto pr-2">
                    <!-- Tributes will be inserted here -->
                </div>
            </div>
            <!-- Global Legacy Map -->
            <div id="map-section" class="lg:col-span-2 card p-6 rounded-2xl">
                 <h2 class="text-3xl font-bold text-white text-center">Global Legacy Map</h2>
                 <p class="text-zinc-400 mt-2 text-center">Visualizing the candles, memories, and tributes from around the world.</p>
                 <p class="text-center mt-2 text-sm font-bold text-amber-400"><span id="country-count">0</span> countries represented</p>
                <div id="map" class="h-96 w-full rounded-lg mt-4 z-0"></div>
            </div>
        </section>

    </div>

    <!-- Modals -->
    <div id="modal-container" class="fixed inset-0 z-50 hidden items-center justify-center p-4" style="background-color: rgba(0,0,0,0.8); backdrop-filter: blur(5px);">
        <!-- Candle Modal -->
        <div id="candle-modal" class="card p-8 rounded-2xl w-full max-w-md hidden">
             <h2 class="text-2xl font-bold text-white mb-4">Light Your Candle</h2>
             <form id="candle-form" class="space-y-4">
                 <div>
                    <label for="candle-name" class="block text-sm font-medium text-zinc-300">Your Name</label>
                    <input type="text" id="candle-name" class="mt-1 w-full bg-zinc-800 border-zinc-700 rounded-lg px-3 py-2 text-white focus:ring-red-500 focus:border-red-500" required>
                 </div>
                 <div>
                    <label for="candle-city" class="block text-sm font-medium text-zinc-300">City (India)</label>
                    <select id="candle-city" class="mt-1 w-full bg-zinc-800 border-zinc-700 rounded-lg px-3 py-2 text-white focus:ring-red-500 focus:border-red-500">
                        <option value="">Select a city</option>
                    </select>
                 </div>
                 <div>
                    <label for="candle-state" class="block text-sm font-medium text-zinc-300">State</label>
                    <input type="text" id="candle-state" class="mt-1 w-full bg-zinc-700 border-zinc-600 rounded-lg px-3 py-2 text-white" readonly>
                 </div>
                 <p class="text-xs text-zinc-400 text-center">For international locations, please add a memory or tribute pin on the map.</p>
                 <div class="flex gap-4 pt-4">
                    <button type="submit" class="w-full btn-primary font-semibold py-2 px-4 rounded-lg">Submit</button>
                    <button type="button" id="cancel-candle" class="w-full bg-zinc-800 hover:bg-zinc-700 text-white font-semibold py-2 px-4 rounded-lg">Cancel</button>
                 </div>
             </form>
        </div>
        <!-- Memory/Tribute Modal -->
        <div id="submission-modal" class="card p-8 rounded-2xl w-full max-w-lg hidden">
            <h2 id="submission-title" class="text-2xl font-bold text-white mb-4"></h2>
            <form id="submission-form" class="space-y-4">
                <input type="hidden" id="submission-type" name="type">
                <div>
                    <label for="submission-name" class="block text-sm font-medium text-zinc-300">Your Name</label>
                    <input type="text" id="submission-name" name="name" class="mt-1 w-full bg-zinc-800 border-zinc-700 rounded-lg px-3 py-2 text-white" required>
                </div>
                 <div>
                    <label for="submission-profession" class="block text-sm font-medium text-zinc-300">Profession/Institute</label>
                    <input type="text" id="submission-profession" name="profession" class="mt-1 w-full bg-zinc-800 border-zinc-700 rounded-lg px-3 py-2 text-white">
                </div>
                 <div>
                    <label for="submission-city" class="block text-sm font-medium text-zinc-300">City, Country</label>
                    <input type="text" id="submission-city" name="city" placeholder="e.g., Guwahati, India" class="mt-1 w-full bg-zinc-800 border-zinc-700 rounded-lg px-3 py-2 text-white" required>
                </div>
                <div>
                    <label id="submission-text-label" for="submission-text" class="block text-sm font-medium text-zinc-300"></label>
                    <textarea id="submission-text" name="text" rows="4" class="mt-1 w-full bg-zinc-800 border-zinc-700 rounded-lg px-3 py-2 text-white" required></textarea>
                </div>
                <div id="link-field-container">
                    <label for="submission-link" class="block text-sm font-medium text-zinc-300">YouTube Link</label>
                    <input type="url" id="submission-link" name="link" placeholder="https://youtube.com/..." class="mt-1 w-full bg-zinc-800 border-zinc-700 rounded-lg px-3 py-2 text-white">
                </div>
                <div class="flex gap-4 pt-4">
                    <button type="submit" class="w-full btn-primary font-semibold py-2 px-4 rounded-lg">Submit</button>
                    <button type="button" id="cancel-submission" class="w-full bg-zinc-800 hover:bg-zinc-700 text-white font-semibold py-2 px-4 rounded-lg">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {

        // --- DATA & CONFIG ---
        const BASE_COUNTS = { candles: 12847, memories: 2847, tributes: 156 };
        const STORAGE_KEYS = {
            CANDLES: 'zubeen_tribute_candles_v2',
            MEMORIES: 'zubeen_tribute_memories_v2',
            TRIBUTES: 'zubeen_tribute_tributes_v2',
            CANDLE_LIT: 'zubeen_tribute_candle_lit_v2'
        };
        const INDIAN_CITIES = [
            { city: "Guwahati", state: "Assam" }, { city: "Jorhat", state: "Assam" }, { city: "Dibrugarh", state: "Assam" }, { city: "Silchar", state: "Assam" }, { city: "Tezpur", state: "Assam" },
            { city: "Mumbai", state: "Maharashtra" }, { city: "Delhi", state: "Delhi" }, { city: "Bengaluru", state: "Karnataka" },
            { city: "Kolkata", state: "West Bengal" }, { city: "Chennai", state: "Tamil Nadu" }, { city: "Hyderabad", state: "Telangana" },
            { city: "Pune", state: "Maharashtra" }, { city: "Ahmedabad", state: "Gujarat" }, { city: "Jaipur", state: "Rajasthan" },
            { city: "Shillong", state: "Meghalaya" }, { city: "Itanagar", state: "Arunachal Pradesh" },
        ].sort((a, b) => a.city.localeCompare(b.city));

        // --- UI ELEMENTS ---
        const candleBtn = document.getElementById('light-candle-btn');
        const modalContainer = document.getElementById('modal-container');
        const candleModal = document.getElementById('candle-modal');
        const submissionModal = document.getElementById('submission-modal');
        
        // --- HELPERS (Moved up to fix initialization error) ---
        const loadFromStorage = (key, defaultValue) => {
            try { return JSON.parse(localStorage.getItem(key)) || defaultValue; } 
            catch (e) { return defaultValue; }
        };
        const saveToStorage = (key, value) => localStorage.setItem(key, JSON.stringify(value));
        const escapeHTML = str => str ? str.replace(/[&<>"']/g, m => ({'&': '&amp;','<': '&lt;','>': '&gt;','"': '&quot;',"'": '&#039;'})[m]) : '';
        const getYoutubeId = url => {
            if (!url) return null;
            const match = url.match(/[?&]v=([^&]+)|youtu\.be\/([^?&]+)/);
            return match ? match[1] || match[2] : null;
        };
        
        // --- STATE MANAGEMENT ---
        let candles = loadFromStorage(STORAGE_KEYS.CANDLES, []);
        let memories = loadFromStorage(STORAGE_KEYS.MEMORIES, [
             {id: 1, name: "Rohan Das", profession: "Student", city: "Jorhat, India", text: "I first heard 'Ya Ali' in my college hostel. That voice... it became the anthem of our friendship and our dreams. Zubeen da, you are immortal.", timestamp: Date.now() - 20000},
             {id: 2, name: "Priya Sharma", profession: "Software Engineer", city: "Bengaluru, India", text: "Living far from home, his Bihu songs were my connection to Assam. During the toughest times, his music felt like a warm hug from my motherland.", timestamp: Date.now() - 10000},
             {id: 3, name: "John Doe", profession: "Musician", city: "London, UK", text: "I discovered his music through a friend. The emotion in his voice transcends language. A true global artist who inspired me to be fearless with my own art.", timestamp: Date.now()}
        ]);
        let tributes = loadFromStorage(STORAGE_KEYS.TRIBUTES, []);
        let candleLitStatus = loadFromStorage(STORAGE_KEYS.CANDLE_LIT, false);

        // --- MODAL HANDLING ---
        const openModal = (modalElement) => {
            modalContainer.style.display = 'flex';
            modalElement.style.display = 'block';
        };
        const closeModal = () => {
            modalContainer.style.display = 'none';
            candleModal.style.display = 'none';
            submissionModal.style.display = 'none';
        };

        // --- CANDLE LOGIC ---
        function renderCandleStats() {
            const statsContainer = document.getElementById('candle-stats');
            const totalCandles = BASE_COUNTS.candles + candles.length;
            document.getElementById('candle-total-count').textContent = totalCandles.toLocaleString();

            const cityCounts = {};
            const stateCounts = {};
            candles.forEach(c => {
                cityCounts[c.city] = (cityCounts[c.city] || 0) + 1;
                stateCounts[c.state] = (stateCounts[c.state] || 0) + 1;
            });

            const topCities = Object.entries(cityCounts).sort((a,b) => b[1]-a[1]).slice(0,5);
            const topStates = Object.entries(stateCounts).sort((a,b) => b[1]-a[1]).slice(0,5);

            let html = `<div><h4 class="font-semibold text-white mb-2">Top Cities (India)</h4><div class="space-y-2">`;
            if (topCities.length > 0) {
                topCities.forEach(([city, count]) => {
                    html += `<div class="text-sm"><div class="flex justify-between mb-1"><span class="text-zinc-300">${city}</span><span>${count}</span></div><div class="w-full bg-zinc-700 rounded-full h-1.5"><div class="stat-bar h-1.5 rounded-full" style="width: ${Math.max(5, (count / topCities[0][1]) * 100)}%"></div></div></div>`;
                });
            } else { html += `<p class="text-sm text-zinc-500">No candles lit yet.</p>`;}
            html += `</div></div><div><h4 class="font-semibold text-white mb-2 mt-4">Top States (India)</h4><div class="space-y-2">`;
             if (topStates.length > 0) {
                topStates.forEach(([state, count]) => {
                    html += `<div class="text-sm"><div class="flex justify-between mb-1"><span class="text-zinc-300">${state}</span><span>${count}</span></div><div class="w-full bg-zinc-700 rounded-full h-1.5"><div class="stat-bar h-1.5 rounded-full" style="width: ${Math.max(5, (count / topStates[0][1]) * 100)}%"></div></div></div>`;
                });
            } else { html += `<p class="text-sm text-zinc-500">No data yet.</p>`; }
            html += `</div></div>`;
            statsContainer.innerHTML = html;
        }

        function handleCandleClick() {
            if (candleLitStatus) {
                alert("You've already lit a candle in this session. Thank you for your tribute!");
                return;
            }
            openModal(candleModal);
        }

        // --- MEMORY WALL & TRIBUTE HUB LOGIC ---
        let memoryCarouselIndex = 0;
        function renderMemoryCarousel() {
            const carouselContainer = document.getElementById('memory-carousel');
            document.getElementById('memory-count').textContent = (BASE_COUNTS.memories + memories.length).toLocaleString();
            carouselContainer.innerHTML = '';
            memories.forEach((mem, index) => {
                const item = document.createElement('div');
                item.className = 'carousel-item absolute inset-0 p-4 text-center flex flex-col justify-center';
                if (index === 0) item.classList.add('active');
                item.innerHTML = `
                    <p class="text-lg md:text-xl italic text-white">"${escapeHTML(mem.text)}"</p>
                    <p class="mt-4 font-semibold text-amber-400">${escapeHTML(mem.name)}</p>
                    <p class="text-sm text-zinc-400">${escapeHTML(mem.profession || '')} ‚Ä¢ ${escapeHTML(mem.city)}</p>
                `;
                carouselContainer.appendChild(item);
            });
        }
        function startMemoryCarousel() {
            const items = document.querySelectorAll('.carousel-item');
            if (items.length <= 1) return;
            setInterval(() => {
                items[memoryCarouselIndex].classList.remove('active');
                memoryCarouselIndex = (memoryCarouselIndex + 1) % items.length;
                items[memoryCarouselIndex].classList.add('active');
            }, 10000);
        }

        function renderTributes() {
             const grid = document.getElementById('tributes-grid');
             document.getElementById('tribute-count').textContent = (BASE_COUNTS.tributes + tributes.length).toLocaleString();
             grid.innerHTML = tributes.length > 0 ? '' : '<p class="text-sm text-zinc-500 text-center">No tributes submitted yet.</p>';
             [...tributes].reverse().forEach(t => {
                const div = document.createElement('div');
                div.className = 'bg-zinc-800 p-3 rounded-lg';
                let content = `<p class="font-semibold text-white text-sm">${escapeHTML(t.name)}</p><p class="text-xs text-zinc-400 mb-2">${escapeHTML(t.city)}</p>`;
                const youtubeId = t.link ? getYoutubeId(t.link) : null;
                if(youtubeId) {
                    content += `<div class="aspect-w-16 aspect-h-9 my-2"><iframe src="https://www.youtube.com/embed/${youtubeId}" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen class="rounded w-full h-full"></iframe></div>`;
                }
                content += `<p class="text-sm text-zinc-300 italic">"${escapeHTML(t.text)}"</p>`;
                div.innerHTML = content;
                grid.appendChild(div);
             });
        }

        // --- MAP LOGIC ---
        const map = L.map('map').setView([24, 88], 4);
        L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
            attribution: '&copy; CartoDB',
            subdomains: 'abcd',
            maxZoom: 20
        }).addTo(map);
        const markers = L.layerGroup().addTo(map);

        const candleIcon = L.divIcon({className: 'text-2xl', html: 'üïØÔ∏è'});
        const memoryIcon = L.divIcon({className: 'text-2xl', html: '‚ù§Ô∏è'});
        const tributeIcon = L.divIcon({className: 'text-2xl', html: 'üéµ'});

        async function geocodeAndAddMarker(item, type) {
            let lat, lon;
            const cityData = INDIAN_CITIES.find(c => c.city === item.city && c.state === item.state);
            // Basic fallback for non-Indian cities for demo purposes
            if (cityData) {
                 const response = await fetch(`https://nominatim.openstreetmap.org/search?q=${encodeURIComponent(item.city + ',' + item.state)}&format=json&limit=1`);
                 const data = await response.json();
                 if (data.length > 0) { [lat, lon] = [data[0].lat, data[0].lon]; }
            } else {
                 const response = await fetch(`https://nominatim.openstreetmap.org/search?q=${encodeURIComponent(item.city)}&format=json&limit=1`);
                 const data = await response.json();
                 if (data.length > 0) { [lat, lon] = [data[0].lat, data[0].lon]; }
            }

            if (!lat || !lon) return;
            
            let icon, popupText;
            switch(type) {
                case 'candle':
                    icon = candleIcon;
                    popupText = `<b>üïØÔ∏è Candle by ${escapeHTML(item.name)}</b><br>${escapeHTML(item.city)}, ${escapeHTML(item.state)}`;
                    break;
                case 'memory':
                    icon = memoryIcon;
                    popupText = `<b>‚ù§Ô∏è Memory by ${escapeHTML(item.name)}</b><br>${escapeHTML(item.city)}<br><i>"${escapeHTML(item.text).substring(0,50)}..."</i>`;
                    break;
                case 'tribute':
                    icon = tributeIcon;
                    popupText = `<b>üéµ Tribute by ${escapeHTML(item.name)}</b><br>${escapeHTML(item.city)}<br><i>"${escapeHTML(item.text).substring(0,50)}..."</i>`;
                    break;
            }
             L.marker([lat, lon], { icon }).addTo(markers).bindPopup(popupText);
        }

        function renderAllMarkers() {
            markers.clearLayers();
            const allCountries = new Set();
            candles.forEach(c => {
                geocodeAndAddMarker({ ...c }, 'candle');
                allCountries.add('India');
            });
            memories.forEach(m => {
                 geocodeAndAddMarker(m, 'memory');
                 allCountries.add(m.city.split(',').pop().trim());
            });
            tributes.forEach(t => {
                geocodeAndAddMarker(t, 'tribute');
                allCountries.add(t.city.split(',').pop().trim());
            });
            document.getElementById('country-count').textContent = allCountries.size;
        }

        // --- INITIALIZATION & EVENT LISTENERS ---
        
        const citySelect = document.getElementById('candle-city');
        INDIAN_CITIES.forEach(c => {
            const option = document.createElement('option');
            option.value = c.city;
            option.textContent = c.city;
            citySelect.appendChild(option);
        });
        citySelect.addEventListener('change', (e) => {
            const selectedCity = INDIAN_CITIES.find(c => c.city === e.target.value);
            document.getElementById('candle-state').value = selectedCity ? selectedCity.state : '';
        });

        document.getElementById('candle-form').addEventListener('submit', (e) => {
            e.preventDefault();
            const name = document.getElementById('candle-name').value;
            const city = document.getElementById('candle-city').value;
            const state = document.getElementById('candle-state').value;
            if (!city || !state) { alert("Please select a valid city."); return; }
            
            candles.push({ id: Date.now(), name, city, state, country: "India" });
            saveToStorage(STORAGE_KEYS.CANDLES, candles);
            candleLitStatus = true;
            saveToStorage(STORAGE_KEYS.CANDLE_LIT, true);

            renderCandleStats();
            renderAllMarkers();
            closeModal();
        });

        const setupSubmissionForm = (type) => {
             const titleEl = document.getElementById('submission-title');
             const typeInput = document.getElementById('submission-type');
             const textLabel = document.getElementById('submission-text-label');
             const linkContainer = document.getElementById('link-field-container');

             typeInput.value = type;
             if(type === 'memory'){
                titleEl.textContent = 'Share Your Memory';
                textLabel.textContent = 'Your Memory';
                linkContainer.style.display = 'none';
             } else {
                titleEl.textContent = 'Submit Your Tribute';
                textLabel.textContent = 'Description';
                linkContainer.style.display = 'block';
             }
            openModal(submissionModal);
        }

        document.getElementById('add-memory-btn').addEventListener('click', () => setupSubmissionForm('memory'));
        document.getElementById('add-tribute-btn').addEventListener('click', () => setupSubmissionForm('tribute'));

        document.getElementById('submission-form').addEventListener('submit', e => {
            e.preventDefault();
            const formData = new FormData(e.target);
            const data = Object.fromEntries(formData.entries());
            data.id = Date.now();
            
            if (data.type === 'memory') {
                memories.push(data);
                saveToStorage(STORAGE_KEYS.MEMORIES, memories);
                renderMemoryCarousel();
            } else {
                tributes.push(data);
                saveToStorage(STORAGE_KEYS.TRIBUTES, tributes);
                renderTributes();
            }
            
            renderAllMarkers();
            e.target.reset();
            closeModal();
        });
        
        candleBtn.addEventListener('click', handleCandleClick);
        document.getElementById('cancel-candle').addEventListener('click', closeModal);
        document.getElementById('cancel-submission').addEventListener('click', closeModal);

        // Initial render
        renderCandleStats();
        renderMemoryCarousel();
        startMemoryCarousel();
        renderTributes();
        renderAllMarkers();
    });
    </script>
</body>
</html>

